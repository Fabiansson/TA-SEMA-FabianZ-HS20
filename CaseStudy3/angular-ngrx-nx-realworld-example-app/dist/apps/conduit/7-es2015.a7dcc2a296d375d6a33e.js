(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{CRCv:function(t,e,r){"use strict";r.r(e),r.d(e,"EditorModule",function(){return k});var i=r("gy9y"),c=r("AxuA"),a=r("ofXK"),s=r("tyNb"),o=r("9jGm"),n=r("l7P3"),l=r("LRne"),d=r("zp1y"),b=r("bOdf"),u=r("lJxs"),p=r("JIr8"),h=r("A47K"),f=r("fXoL");let O=(()=>{class t{constructor(t){this.apiService=t}publishArticle(t){return t.slug?this.apiService.put("/articles/"+t.slug,{article:t}):this.apiService.post("/articles/",{article:t})}get(t){return this.apiService.get("/articles/"+t)}}return t.\u0275fac=function(e){return new(e||t)(f.Pb(h.b))},t.\u0275prov=f.Db({token:t,factory:t.\u0275fac}),t})();const g=Object(n.n)("[editor] PUBLISH_ARTICLE"),m=Object(n.n)("[editor] INITIALIZE_ARTICLE"),v=Object(n.n)("[editor] LOAD_ARTICLE",Object(n.s)()),j=Object(n.n)("[editor] LOAD_ARTICLE_SUCCESS",Object(n.s)()),A=Object(n.n)("[editor] LOAD_ARTICLE_FAIL",Object(n.s)());var F=r("EdWO");let y=(()=>{class t{constructor(t,e,r){this.actions$=t,this.ngrxFormsFacade=e,this.editorService=r,this.publishArticle$=Object(o.c)(()=>this.actions$.pipe(Object(o.d)(g),Object(d.a)(this.ngrxFormsFacade.data$),Object(b.a)(([t,e])=>this.editorService.publishArticle(e).pipe(Object(u.a)(t=>Object(F.b)({to:{path:["article",t.article.slug]}})),Object(p.a)(t=>Object(l.a)(Object(c.d)({errors:t.error.errors}))))))),this.loadArticle$=Object(o.c)(()=>this.actions$.pipe(Object(o.d)(v),Object(b.a)(t=>this.editorService.get(t.id).pipe(Object(u.a)(t=>j({article:t.article})),Object(p.a)(t=>Object(l.a)(A(t)))))))}}return t.\u0275fac=function(e){return new(e||t)(f.Pb(o.a),f.Pb(c.a),f.Pb(O))},t.\u0275prov=f.Db({token:t,factory:t.\u0275fac}),t})();const L={article:{slug:"",title:"",description:"",body:"",tagList:[],createdAt:"",updatedAt:"",favorited:!1,favoritesCount:0,author:{username:"",bio:"",image:"",following:!1,loading:!1}}},S=Object(n.p)(L,Object(n.r)(j,(t,e)=>Object.assign(Object.assign({},t),{article:e.article})),Object(n.r)(A,m,()=>L));function $(t,e){return S(t,e)}const I=Object(n.o)("editor"),w={getArticle:Object(n.q)(I,t=>t.article)};let x=(()=>{class t{constructor(t){this.store=t,this.article$=this.store.select(w.getArticle)}loadArticle(t){this.store.dispatch(v({id:t}))}loadArticleSuccess(t){this.store.dispatch(j({article:t}))}loadArticleFail(t){this.store.dispatch(A({error:t}))}publishArticle(){this.store.dispatch(g())}initializeArticle(){this.store.dispatch(m())}}return t.\u0275fac=function(e){return new(e||t)(f.Pb(n.h))},t.\u0275prov=f.Db({token:t,factory:t.\u0275fac}),t})();var E=r("3Pt+"),T=r("T7Fx"),P=r("5W4/");const C=[{type:"INPUT",name:"title",placeholder:"Article Title",validator:[E.h.required]},{type:"INPUT",name:"description",placeholder:"What's this article about?",validator:[E.h.required]},{type:"TEXTAREA",name:"body",placeholder:"Write your article (in markdown)",validator:[E.h.required]},{type:"INPUT",name:"tagList",placeholder:"Enter Tags",validator:[]}];let D=(()=>{class t{constructor(t,e,r){this.ngrxFormsFacade=t,this.router=e,this.facade=r}ngOnInit(){this.ngrxFormsFacade.setStructure(C),this.data$=this.ngrxFormsFacade.data$,this.structure$=this.ngrxFormsFacade.structure$,this.facade.article$.subscribe(t=>this.ngrxFormsFacade.setData(t))}updateForm(t){this.ngrxFormsFacade.updateData(t)}submit(){this.facade.publishArticle()}ngOnDestroy(){this.ngrxFormsFacade.initializeForm(),this.facade.initializeArticle()}}return t.\u0275fac=function(e){return new(e||t)(f.Hb(c.a),f.Hb(s.e),f.Hb(x))},t.\u0275cmp=f.Bb({type:t,selectors:[["app-article-editor"]],decls:8,vars:2,consts:[[1,"editor-page"],[1,"container","page"],[1,"row"],[1,"col-md-10","offset-md-1","col-xs-12"],[3,"data$","structure$","updateForm"],["type","button",1,"btn","btn-lg","pull-xs-right","btn-primary",3,"click"]],template:function(t,e){1&t&&(f.Lb(0,"div",0),f.Lb(1,"div",1),f.Lb(2,"div",2),f.Lb(3,"div",3),f.Ib(4,"app-list-errors"),f.Lb(5,"app-dynamic-form",4),f.Sb("updateForm",function(t){return e.updateForm(t)}),f.Kb(),f.Lb(6,"button",5),f.Sb("click",function(){return e.submit()}),f.ic(7," Publish Article "),f.Kb(),f.Kb(),f.Kb(),f.Kb(),f.Kb()),2&t&&(f.xb(5),f.Yb("data$",e.data$)("structure$",e.structure$))},directives:[T.a,P.a],styles:[""],changeDetection:0}),t})(),R=(()=>{class t{constructor(t){this.facade=t}resolve(t,e){const r=t.params.slug;return r&&this.facade.loadArticle(r),Object(l.a)(!0)}}return t.\u0275fac=function(e){return new(e||t)(f.Pb(x))},t.\u0275prov=f.Db({token:t,factory:t.\u0275fac}),t})(),k=(()=>{class t{}return t.\u0275mod=f.Fb({type:t}),t.\u0275inj=f.Eb({factory:function(e){return new(e||t)},providers:[y,O,R,x],imports:[[a.c,c.b,s.h.forChild([{path:"",pathMatch:"full",component:D,resolve:{EditorResolverService:R},canActivate:[i.b]},{path:":slug",component:D,resolve:{EditorResolverService:R}}]),n.j.forFeature("editor",$,{initialState:L}),o.b.forFeature([y])]]}),t})()}}]);